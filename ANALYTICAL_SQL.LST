SQL> SELECT Ename, Sal
  2   FROM Emp
  3   ORDER BY Sal DESC;

ENAME             SAL                                                                                                                                                                                   
---------- ----------                                                                                                                                                                                   
KING             5000                                                                                                                                                                                   
FORD             3000                                                                                                                                                                                   
SCOTT            3000                                                                                                                                                                                   
JONES            2975                                                                                                                                                                                   
BLAKE            2850                                                                                                                                                                                   
CLARK            2450                                                                                                                                                                                   
ALLEN            1600                                                                                                                                                                                   
TURNER           1500                                                                                                                                                                                   
MILLER           1300                                                                                                                                                                                   
WARD             1250                                                                                                                                                                                   
MARTIN           1250                                                                                                                                                                                   
ADAMS            1100                                                                                                                                                                                   
JAMES             950                                                                                                                                                                                   
SMITH             800                                                                                                                                                                                   

14 rows selected.

SQL> SELECT EName, Deptno, Sal,
  2   RANK()
  3   OVER(ORDER BY Sal) EmpRank
  4   FROM Emp;

ENAME          DEPTNO        SAL    EMPRANK                                                                                                                                                             
---------- ---------- ---------- ----------                                                                                                                                                             
SMITH              20        800          1                                                                                                                                                             
JAMES              30        950          2                                                                                                                                                             
ADAMS              20       1100          3                                                                                                                                                             
WARD               30       1250          4                                                                                                                                                             
MARTIN             30       1250          4                                                                                                                                                             
MILLER             10       1300          6                                                                                                                                                             
TURNER             30       1500          7                                                                                                                                                             
ALLEN              30       1600          8                                                                                                                                                             
CLARK              10       2450          9                                                                                                                                                             
BLAKE              30       2850         10                                                                                                                                                             
JONES              20       2975         11                                                                                                                                                             
SCOTT              20       3000         12                                                                                                                                                             
FORD               20       3000         12                                                                                                                                                             
KING               10       5000         14                                                                                                                                                             

14 rows selected.

SQL> SELECT EName, Deptno, Sal,
  2   RANK()
  3   OVER(ORDER BY Sal) EmpRank
  4   FROM Emp
  5   GROUP BY Deptno, EName, Sal
  6   ORDER BY Emprank;

ENAME          DEPTNO        SAL    EMPRANK                                                                                                                                                             
---------- ---------- ---------- ----------                                                                                                                                                             
SMITH              20        800          1                                                                                                                                                             
JAMES              30        950          2                                                                                                                                                             
ADAMS              20       1100          3                                                                                                                                                             
MARTIN             30       1250          4                                                                                                                                                             
WARD               30       1250          4                                                                                                                                                             
MILLER             10       1300          6                                                                                                                                                             
TURNER             30       1500          7                                                                                                                                                             
ALLEN              30       1600          8                                                                                                                                                             
CLARK              10       2450          9                                                                                                                                                             
BLAKE              30       2850         10                                                                                                                                                             
JONES              20       2975         11                                                                                                                                                             
FORD               20       3000         12                                                                                                                                                             
SCOTT              20       3000         12                                                                                                                                                             
KING               10       5000         14                                                                                                                                                             

14 rows selected.

SQL> SELECT EName, Deptno, Sal,
  2   RANK()
  3   OVER(ORDER BY Sal) EmpRank
  4   FROM Emp
  5   GROUP BY Deptno, EName, Sal
  6   ORDER BY Emprank DESC;

ENAME          DEPTNO        SAL    EMPRANK                                                                                                                                                             
---------- ---------- ---------- ----------                                                                                                                                                             
KING               10       5000         14                                                                                                                                                             
SCOTT              20       3000         12                                                                                                                                                             
FORD               20       3000         12                                                                                                                                                             
JONES              20       2975         11                                                                                                                                                             
BLAKE              30       2850         10                                                                                                                                                             
CLARK              10       2450          9                                                                                                                                                             
ALLEN              30       1600          8                                                                                                                                                             
TURNER             30       1500          7                                                                                                                                                             
MILLER             10       1300          6                                                                                                                                                             
WARD               30       1250          4                                                                                                                                                             
MARTIN             30       1250          4                                                                                                                                                             
ADAMS              20       1100          3                                                                                                                                                             
JAMES              30        950          2                                                                                                                                                             
SMITH              20        800          1                                                                                                                                                             

14 rows selected.

SQL> SELECT EName, Deptno, Sal,
  2   RANK()
  3   OVER(ORDER BY Sal DESC) EmpRank
  4   FROM Emp
  5   GROUP BY Deptno, EName, Sal
  6   ORDER BY Emprank;

ENAME          DEPTNO        SAL    EMPRANK                                                                                                                                                             
---------- ---------- ---------- ----------                                                                                                                                                             
KING               10       5000          1                                                                                                                                                             
FORD               20       3000          2                                                                                                                                                             
SCOTT              20       3000          2                                                                                                                                                             
JONES              20       2975          4                                                                                                                                                             
BLAKE              30       2850          5                                                                                                                                                             
CLARK              10       2450          6                                                                                                                                                             
ALLEN              30       1600          7                                                                                                                                                             
TURNER             30       1500          8                                                                                                                                                             
MILLER             10       1300          9                                                                                                                                                             
MARTIN             30       1250         10                                                                                                                                                             
WARD               30       1250         10                                                                                                                                                             
ADAMS              20       1100         12                                                                                                                                                             
JAMES              30        950         13                                                                                                                                                             
SMITH              20        800         14                                                                                                                                                             

14 rows selected.

SQL> SELECT EName, Deptno, Sal,
  2   RANK()
  3   OVER(ORDER BY Sal DESC) EmpRank
  4   FROM Emp
  5   GROUP BY Deptno, EName, Sal
  6   ORDER BY Emprank DESC
  7  ;

ENAME          DEPTNO        SAL    EMPRANK                                                                                                                                                             
---------- ---------- ---------- ----------                                                                                                                                                             
SMITH              20        800         14                                                                                                                                                             
JAMES              30        950         13                                                                                                                                                             
ADAMS              20       1100         12                                                                                                                                                             
WARD               30       1250         10                                                                                                                                                             
MARTIN             30       1250         10                                                                                                                                                             
MILLER             10       1300          9                                                                                                                                                             
TURNER             30       1500          8                                                                                                                                                             
ALLEN              30       1600          7                                                                                                                                                             
CLARK              10       2450          6                                                                                                                                                             
BLAKE              30       2850          5                                                                                                                                                             
JONES              20       2975          4                                                                                                                                                             
SCOTT              20       3000          2                                                                                                                                                             
FORD               20       3000          2                                                                                                                                                             
KING               10       5000          1                                                                                                                                                             

14 rows selected.

SQL> SELECT EName, Deptno, Sal,
  2   RANK()
  3   OVER(ORDER BY Sal DESC) EmpRank
  4   FROM Emp;

ENAME          DEPTNO        SAL    EMPRANK                                                                                                                                                             
---------- ---------- ---------- ----------                                                                                                                                                             
KING               10       5000          1                                                                                                                                                             
FORD               20       3000          2                                                                                                                                                             
SCOTT              20       3000          2                                                                                                                                                             
JONES              20       2975          4                                                                                                                                                             
BLAKE              30       2850          5                                                                                                                                                             
CLARK              10       2450          6                                                                                                                                                             
ALLEN              30       1600          7                                                                                                                                                             
TURNER             30       1500          8                                                                                                                                                             
MILLER             10       1300          9                                                                                                                                                             
WARD               30       1250         10                                                                                                                                                             
MARTIN             30       1250         10                                                                                                                                                             
ADAMS              20       1100         12                                                                                                                                                             
JAMES              30        950         13                                                                                                                                                             
SMITH              20        800         14                                                                                                                                                             

14 rows selected.

SQL> ED
Wrote file afiedt.buf

  1  SELECT EName, Deptno, Sal,
  2   RANK()
  3   OVER(ORDER BY Sal ASC) EmpRank
  4*  FROM Emp
SQL> /

ENAME          DEPTNO        SAL    EMPRANK                                                                                                                                                             
---------- ---------- ---------- ----------                                                                                                                                                             
SMITH              20        800          1                                                                                                                                                             
JAMES              30        950          2                                                                                                                                                             
ADAMS              20       1100          3                                                                                                                                                             
WARD               30       1250          4                                                                                                                                                             
MARTIN             30       1250          4                                                                                                                                                             
MILLER             10       1300          6                                                                                                                                                             
TURNER             30       1500          7                                                                                                                                                             
ALLEN              30       1600          8                                                                                                                                                             
CLARK              10       2450          9                                                                                                                                                             
BLAKE              30       2850         10                                                                                                                                                             
JONES              20       2975         11                                                                                                                                                             
SCOTT              20       3000         12                                                                                                                                                             
FORD               20       3000         12                                                                                                                                                             
KING               10       5000         14                                                                                                                                                             

14 rows selected.

SQL> SELECT EName, Deptno, Sal,
  2   RANK()
  3   OVER(ORDER BY Sal DESC) EmpRank
  4   FROM Emp
  5   GROUP BY Deptno, EName, Sal;

ENAME          DEPTNO        SAL    EMPRANK                                                                                                                                                             
---------- ---------- ---------- ----------                                                                                                                                                             
KING               10       5000          1                                                                                                                                                             
FORD               20       3000          2                                                                                                                                                             
SCOTT              20       3000          2                                                                                                                                                             
JONES              20       2975          4                                                                                                                                                             
BLAKE              30       2850          5                                                                                                                                                             
CLARK              10       2450          6                                                                                                                                                             
ALLEN              30       1600          7                                                                                                                                                             
TURNER             30       1500          8                                                                                                                                                             
MILLER             10       1300          9                                                                                                                                                             
MARTIN             30       1250         10                                                                                                                                                             
WARD               30       1250         10                                                                                                                                                             
ADAMS              20       1100         12                                                                                                                                                             
JAMES              30        950         13                                                                                                                                                             
SMITH              20        800         14                                                                                                                                                             

14 rows selected.

SQL> SELECT EName, Deptno, Sal,
  2   RANK()
  3   OVER(ORDER BY Sal DESC) EmpRank
  4   FROM Emp
  5   GROUP BY Deptno, EName, Sal
  6   ORDER BY Emprank;

ENAME          DEPTNO        SAL    EMPRANK                                                                                                                                                             
---------- ---------- ---------- ----------                                                                                                                                                             
KING               10       5000          1                                                                                                                                                             
FORD               20       3000          2                                                                                                                                                             
SCOTT              20       3000          2                                                                                                                                                             
JONES              20       2975          4                                                                                                                                                             
BLAKE              30       2850          5                                                                                                                                                             
CLARK              10       2450          6                                                                                                                                                             
ALLEN              30       1600          7                                                                                                                                                             
TURNER             30       1500          8                                                                                                                                                             
MILLER             10       1300          9                                                                                                                                                             
MARTIN             30       1250         10                                                                                                                                                             
WARD               30       1250         10                                                                                                                                                             
ADAMS              20       1100         12                                                                                                                                                             
JAMES              30        950         13                                                                                                                                                             
SMITH              20        800         14                                                                                                                                                             

14 rows selected.

SQL> ED
Wrote file afiedt.buf

  1  SELECT EName, Deptno, Sal,
  2   RANK()
  3   OVER(ORDER BY Sal DESC) EmpRank
  4   FROM Emp
  5   GROUP BY Deptno, EName, Sal
  6   ORDER BY Emprank
  7*  DESC
SQL> /

ENAME          DEPTNO        SAL    EMPRANK                                                                                                                                                             
---------- ---------- ---------- ----------                                                                                                                                                             
SMITH              20        800         14                                                                                                                                                             
JAMES              30        950         13                                                                                                                                                             
ADAMS              20       1100         12                                                                                                                                                             
WARD               30       1250         10                                                                                                                                                             
MARTIN             30       1250         10                                                                                                                                                             
MILLER             10       1300          9                                                                                                                                                             
TURNER             30       1500          8                                                                                                                                                             
ALLEN              30       1600          7                                                                                                                                                             
CLARK              10       2450          6                                                                                                                                                             
BLAKE              30       2850          5                                                                                                                                                             
JONES              20       2975          4                                                                                                                                                             
SCOTT              20       3000          2                                                                                                                                                             
FORD               20       3000          2                                                                                                                                                             
KING               10       5000          1                                                                                                                                                             

14 rows selected.

SQL> ED
Wrote file afiedt.buf

  1  SELECT EName, Deptno, Sal,
  2   RANK()
  3   OVER(ORDER BY Sal DESC) EmpRank
  4   FROM Emp
  5   ORDER BY Emprank
  6*  DESC
SQL> /

ENAME          DEPTNO        SAL    EMPRANK                                                                                                                                                             
---------- ---------- ---------- ----------                                                                                                                                                             
SMITH              20        800         14                                                                                                                                                             
JAMES              30        950         13                                                                                                                                                             
ADAMS              20       1100         12                                                                                                                                                             
MARTIN             30       1250         10                                                                                                                                                             
WARD               30       1250         10                                                                                                                                                             
MILLER             10       1300          9                                                                                                                                                             
TURNER             30       1500          8                                                                                                                                                             
ALLEN              30       1600          7                                                                                                                                                             
CLARK              10       2450          6                                                                                                                                                             
BLAKE              30       2850          5                                                                                                                                                             
JONES              20       2975          4                                                                                                                                                             
SCOTT              20       3000          2                                                                                                                                                             
FORD               20       3000          2                                                                                                                                                             
KING               10       5000          1                                                                                                                                                             

14 rows selected.

SQL> INSERT INTO EMP (EMPNO,ENAME,DEPTNO,SAL) VALUES (1001,'JAMES',30,1000);

1 row created.

SQL> COMMIT;

Commit complete.

SQL> SELECT EName, Deptno,
  2   RANK()
  3   OVER(ORDER BY Sal DESC) EmpRank
  4   FROM Emp
  5   GROUP BY Deptno, EName, Sal
  6   ORDER BY Emprank DESC;

ENAME          DEPTNO    EMPRANK                                                                                                                                                                        
---------- ---------- ----------                                                                                                                                                                        
SMITH              20         15                                                                                                                                                                        
JAMES              30         14                                                                                                                                                                        
JAMES              30         13                                                                                                                                                                        
ADAMS              20         12                                                                                                                                                                        
WARD               30         10                                                                                                                                                                        
MARTIN             30         10                                                                                                                                                                        
MILLER             10          9                                                                                                                                                                        
TURNER             30          8                                                                                                                                                                        
ALLEN              30          7                                                                                                                                                                        
CLARK              10          6                                                                                                                                                                        
BLAKE              30          5                                                                                                                                                                        
JONES              20          4                                                                                                                                                                        
SCOTT              20          2                                                                                                                                                                        
FORD               20          2                                                                                                                                                                        
KING               10          1                                                                                                                                                                        

15 rows selected.

SQL> SELECT EName, Deptno,sal
  2   RANK()
  3   OVER(ORDER BY Sal DESC) EmpRank
  4   FROM Emp
  5   GROUP BY Deptno, EName, Sal
  6   ORDER BY Emprank DESC;
 RANK()
     *
ERROR at line 2:
ORA-00923: FROM keyword not found where expected 


SQL> SELECT EName, Deptno,sal,
  2   RANK()
  3   OVER(ORDER BY Sal DESC) EmpRank
  4   FROM Emp
  5   GROUP BY Deptno, EName, Sal
  6   ORDER BY Emprank DESC;

ENAME          DEPTNO        SAL    EMPRANK                                                                                                                                                             
---------- ---------- ---------- ----------                                                                                                                                                             
SMITH              20        800         15                                                                                                                                                             
JAMES              30        950         14                                                                                                                                                             
JAMES              30       1000         13                                                                                                                                                             
ADAMS              20       1100         12                                                                                                                                                             
WARD               30       1250         10                                                                                                                                                             
MARTIN             30       1250         10                                                                                                                                                             
MILLER             10       1300          9                                                                                                                                                             
TURNER             30       1500          8                                                                                                                                                             
ALLEN              30       1600          7                                                                                                                                                             
CLARK              10       2450          6                                                                                                                                                             
BLAKE              30       2850          5                                                                                                                                                             
JONES              20       2975          4                                                                                                                                                             
SCOTT              20       3000          2                                                                                                                                                             
FORD               20       3000          2                                                                                                                                                             
KING               10       5000          1                                                                                                                                                             

15 rows selected.

SQL> UPDATE EMP SET SAL=950 WHERE SAL=1000;

1 row updated.

SQL> SELECT EName, Deptno,sal,
  2   RANK()
  3   OVER(ORDER BY Sal DESC) EmpRank
  4   FROM Emp
  5   GROUP BY Deptno, EName, Sal
  6   ORDER BY Emprank DESC;

ENAME          DEPTNO        SAL    EMPRANK                                                                                                                                                             
---------- ---------- ---------- ----------                                                                                                                                                             
SMITH              20        800         14                                                                                                                                                             
JAMES              30        950         13                                                                                                                                                             
ADAMS              20       1100         12                                                                                                                                                             
WARD               30       1250         10                                                                                                                                                             
MARTIN             30       1250         10                                                                                                                                                             
MILLER             10       1300          9                                                                                                                                                             
TURNER             30       1500          8                                                                                                                                                             
ALLEN              30       1600          7                                                                                                                                                             
CLARK              10       2450          6                                                                                                                                                             
BLAKE              30       2850          5                                                                                                                                                             
JONES              20       2975          4                                                                                                                                                             
SCOTT              20       3000          2                                                                                                                                                             
FORD               20       3000          2                                                                                                                                                             
KING               10       5000          1                                                                                                                                                             

14 rows selected.

SQL> SELECT EName, Deptno, Sal,
  2   DENSE_RANK()
  3   OVER(ORDER BY Sal DESC) EmpRank
  4   FROM Emp
  5   GROUP BY Deptno, EName, Sal
  6   ORDER BY EmpRank;

ENAME          DEPTNO        SAL    EMPRANK                                                                                                                                                             
---------- ---------- ---------- ----------                                                                                                                                                             
KING               10       5000          1                                                                                                                                                             
FORD               20       3000          2                                                                                                                                                             
SCOTT              20       3000          2                                                                                                                                                             
JONES              20       2975          3                                                                                                                                                             
BLAKE              30       2850          4                                                                                                                                                             
CLARK              10       2450          5                                                                                                                                                             
ALLEN              30       1600          6                                                                                                                                                             
TURNER             30       1500          7                                                                                                                                                             
MILLER             10       1300          8                                                                                                                                                             
MARTIN             30       1250          9                                                                                                                                                             
WARD               30       1250          9                                                                                                                                                             
ADAMS              20       1100         10                                                                                                                                                             
JAMES              30        950         11                                                                                                                                                             
SMITH              20        800         12                                                                                                                                                             

14 rows selected.

SQL> -- INLINE VIEW
SQL> 
SQL> SELECT SUM(SAL) FROM (SELECT SAL FROM EMP WHERE SAL<1500);

  SUM(SAL)                                                                                                                                                                                              
----------                                                                                                                                                                                              
      7600                                                                                                                                                                                              

SQL> SELECT SUM(SAL) FROM EMP
  2  WHERE SAL<1500;

  SUM(SAL)                                                                                                                                                                                              
----------                                                                                                                                                                                              
      7600                                                                                                                                                                                              

SQL> SELECT EName, Deptno, Sal,
  2   DENSE_RANK()
  3   OVER(ORDER BY Sal DESC) EmpRank
  4   FROM Emp
  5   GROUP BY Deptno, EName, Sal
  6   ORDER BY EmpRank;

ENAME          DEPTNO        SAL    EMPRANK                                                                                                                                                             
---------- ---------- ---------- ----------                                                                                                                                                             
KING               10       5000          1                                                                                                                                                             
FORD               20       3000          2                                                                                                                                                             
SCOTT              20       3000          2                                                                                                                                                             
JONES              20       2975          3                                                                                                                                                             
BLAKE              30       2850          4                                                                                                                                                             
CLARK              10       2450          5                                                                                                                                                             
ALLEN              30       1600          6                                                                                                                                                             
TURNER             30       1500          7                                                                                                                                                             
MILLER             10       1300          8                                                                                                                                                             
MARTIN             30       1250          9                                                                                                                                                             
WARD               30       1250          9                                                                                                                                                             
ADAMS              20       1100         10                                                                                                                                                             
JAMES              30        950         11                                                                                                                                                             
SMITH              20        800         12                                                                                                                                                             

14 rows selected.

SQL> SELECT ROWNUM, E1.*
  2   FROM (SELECT EName, Deptno, Sal,
  3   DENSE_RANK()
  4   OVER(ORDER BY Sal DESC) EmpRank
  5   FROM Emp
  6   GROUP BY Deptno, EName, Sal
  7   ORDER BY EmpRank) E1
  8   ORDER BY ROWNUM;

    ROWNUM ENAME          DEPTNO        SAL    EMPRANK                                                                                                                                                  
---------- ---------- ---------- ---------- ----------                                                                                                                                                  
         1 KING               10       5000          1                                                                                                                                                  
         2 FORD               20       3000          2                                                                                                                                                  
         3 SCOTT              20       3000          2                                                                                                                                                  
         4 JONES              20       2975          3                                                                                                                                                  
         5 BLAKE              30       2850          4                                                                                                                                                  
         6 CLARK              10       2450          5                                                                                                                                                  
         7 ALLEN              30       1600          6                                                                                                                                                  
         8 TURNER             30       1500          7                                                                                                                                                  
         9 MILLER             10       1300          8                                                                                                                                                  
        10 MARTIN             30       1250          9                                                                                                                                                  
        11 WARD               30       1250          9                                                                                                                                                  
        12 ADAMS              20       1100         10                                                                                                                                                  
        13 JAMES              30        950         11                                                                                                                                                  
        14 SMITH              20        800         12                                                                                                                                                  

14 rows selected.

SQL> SELECT EName, Deptno, Sal,
  2   DENSE_RANK()
  3   OVER(ORDER BY Sal DESC) EmpRank
  4   FROM Emp
  5   GROUP BY Deptno, EName, Sal
  6   ORDER BY EmpRank;

ENAME          DEPTNO        SAL    EMPRANK                                                                                                                                                             
---------- ---------- ---------- ----------                                                                                                                                                             
KING               10       5000          1                                                                                                                                                             
FORD               20       3000          2                                                                                                                                                             
SCOTT              20       3000          2                                                                                                                                                             
JONES              20       2975          3                                                                                                                                                             
BLAKE              30       2850          4                                                                                                                                                             
CLARK              10       2450          5                                                                                                                                                             
ALLEN              30       1600          6                                                                                                                                                             
TURNER             30       1500          7                                                                                                                                                             
MILLER             10       1300          8                                                                                                                                                             
MARTIN             30       1250          9                                                                                                                                                             
WARD               30       1250          9                                                                                                                                                             
ADAMS              20       1100         10                                                                                                                                                             
JAMES              30        950         11                                                                                                                                                             
SMITH              20        800         12                                                                                                                                                             

14 rows selected.

SQL> ED
Wrote file afiedt.buf

  1  SELECT ROWNUM,EName, Deptno, Sal,
  2   DENSE_RANK()
  3   OVER(ORDER BY Sal DESC) EmpRank
  4   FROM Emp
  5   GROUP BY Deptno, EName, Sal
  6*  ORDER BY EmpRank,ROWNUM
SQL> /
SELECT ROWNUM,EName, Deptno, Sal,
       *
ERROR at line 1:
ORA-00979: not a GROUP BY expression 


SQL> ED
Wrote file afiedt.buf

  1  SELECT ROWNUM,EName, Deptno, Sal,
  2   DENSE_RANK()
  3   OVER(ORDER BY Sal DESC) EmpRank
  4   FROM Emp
  5   GROUP BY Deptno, EName, Sal,ROWNUM
  6*  ORDER BY EmpRank,ROWNUM
SQL> /

    ROWNUM ENAME          DEPTNO        SAL    EMPRANK                                                                                                                                                  
---------- ---------- ---------- ---------- ----------                                                                                                                                                  
         9 KING               10       5000          1                                                                                                                                                  
         8 SCOTT              20       3000          2                                                                                                                                                  
        13 FORD               20       3000          2                                                                                                                                                  
         4 JONES              20       2975          3                                                                                                                                                  
         6 BLAKE              30       2850          4                                                                                                                                                  
         7 CLARK              10       2450          5                                                                                                                                                  
         2 ALLEN              30       1600          6                                                                                                                                                  
        10 TURNER             30       1500          7                                                                                                                                                  
        14 MILLER             10       1300          8                                                                                                                                                  
         3 WARD               30       1250          9                                                                                                                                                  
         5 MARTIN             30       1250          9                                                                                                                                                  
        11 ADAMS              20       1100         10                                                                                                                                                  
        12 JAMES              30        950         11                                                                                                                                                  
        15 JAMES              30        950         11                                                                                                                                                  
         1 SMITH              20        800         12                                                                                                                                                  

15 rows selected.

SQL> SELECT ROWNUM, E1.*
  2   FROM (SELECT EName, Deptno, Sal,
  3   DENSE_RANK()
  4   OVER(ORDER BY Sal DESC) EmpRank
  5   FROM Emp
  6   GROUP BY Deptno, EName, Sal
  7   ORDER BY EmpRank) E1
  8   ORDER BY ROWNUM;

    ROWNUM ENAME          DEPTNO        SAL    EMPRANK                                                                                                                                                  
---------- ---------- ---------- ---------- ----------                                                                                                                                                  
         1 KING               10       5000          1                                                                                                                                                  
         2 FORD               20       3000          2                                                                                                                                                  
         3 SCOTT              20       3000          2                                                                                                                                                  
         4 JONES              20       2975          3                                                                                                                                                  
         5 BLAKE              30       2850          4                                                                                                                                                  
         6 CLARK              10       2450          5                                                                                                                                                  
         7 ALLEN              30       1600          6                                                                                                                                                  
         8 TURNER             30       1500          7                                                                                                                                                  
         9 MILLER             10       1300          8                                                                                                                                                  
        10 MARTIN             30       1250          9                                                                                                                                                  
        11 WARD               30       1250          9                                                                                                                                                  
        12 ADAMS              20       1100         10                                                                                                                                                  
        13 JAMES              30        950         11                                                                                                                                                  
        14 SMITH              20        800         12                                                                                                                                                  

14 rows selected.

SQL> ED
Wrote file afiedt.buf

  1  SELECT ROWNUM, E1.*
  2   FROM (SELECT EName, Deptno, Sal,
  3   DENSE_RANK()
  4   OVER(ORDER BY Sal DESC) EmpRank
  5   FROM Emp
  6   GROUP BY Deptno, EName, Sal
  7   ORDER BY EmpRank) E1
  8*  ORDER BY ROWNUM DESC
SQL> /

    ROWNUM ENAME          DEPTNO        SAL    EMPRANK                                                                                                                                                  
---------- ---------- ---------- ---------- ----------                                                                                                                                                  
        14 SMITH              20        800         12                                                                                                                                                  
        13 JAMES              30        950         11                                                                                                                                                  
        12 ADAMS              20       1100         10                                                                                                                                                  
        11 WARD               30       1250          9                                                                                                                                                  
        10 MARTIN             30       1250          9                                                                                                                                                  
         9 MILLER             10       1300          8                                                                                                                                                  
         8 TURNER             30       1500          7                                                                                                                                                  
         7 ALLEN              30       1600          6                                                                                                                                                  
         6 CLARK              10       2450          5                                                                                                                                                  
         5 BLAKE              30       2850          4                                                                                                                                                  
         4 JONES              20       2975          3                                                                                                                                                  
         3 SCOTT              20       3000          2                                                                                                                                                  
         2 FORD               20       3000          2                                                                                                                                                  
         1 KING               10       5000          1                                                                                                                                                  

14 rows selected.

SQL> SELECT
  2   DENSE_RANK()
  3   OVER(ORDER BY Ename) RollNo,
  4   EName, Deptno, Sal
  5   FROM Emp
  6   GROUP BY Deptno, EName, Sal
  7   ORDER BY RollNo;

    ROLLNO ENAME          DEPTNO        SAL                                                                                                                                                             
---------- ---------- ---------- ----------                                                                                                                                                             
         1 ADAMS              20       1100                                                                                                                                                             
         2 ALLEN              30       1600                                                                                                                                                             
         3 BLAKE              30       2850                                                                                                                                                             
         4 CLARK              10       2450                                                                                                                                                             
         5 FORD               20       3000                                                                                                                                                             
         6 JAMES              30        950                                                                                                                                                             
         7 JONES              20       2975                                                                                                                                                             
         8 KING               10       5000                                                                                                                                                             
         9 MARTIN             30       1250                                                                                                                                                             
        10 MILLER             10       1300                                                                                                                                                             
        11 SCOTT              20       3000                                                                                                                                                             
        12 SMITH              20        800                                                                                                                                                             
        13 TURNER             30       1500                                                                                                                                                             
        14 WARD               30       1250                                                                                                                                                             

14 rows selected.

SQL> INSERT INTO Emp(Empno, Ename, Deptno)
  2   VALUES(1234, 'ALLEN', 30);

1 row created.

SQL> INSERT INTO Emp(Empno, Ename, Deptno)
  2   VALUES(1235, 'ALLEN', 30);

1 row created.

SQL> INSERT INTO Emp(Empno, Ename, Deptno)
  2   VALUES(1236, 'ALLEN', 30);

1 row created.

SQL>  SELECT
  2   DENSE_RANK()
  3   OVER(ORDER BY Ename) RollNo,
  4   EName, Deptno, Sal
  5   FROM Emp
  6   GROUP BY Deptno, EName, Sal
  7   ORDER BY RollNo;

    ROLLNO ENAME          DEPTNO        SAL                                                                                                                                                             
---------- ---------- ---------- ----------                                                                                                                                                             
         1 ADAMS              20       1100                                                                                                                                                             
         2 ALLEN              30       1600                                                                                                                                                             
         2 ALLEN              30                                                                                                                                                                        
         3 BLAKE              30       2850                                                                                                                                                             
         4 CLARK              10       2450                                                                                                                                                             
         5 FORD               20       3000                                                                                                                                                             
         6 JAMES              30        950                                                                                                                                                             
         7 JONES              20       2975                                                                                                                                                             
         8 KING               10       5000                                                                                                                                                             
         9 MARTIN             30       1250                                                                                                                                                             
        10 MILLER             10       1300                                                                                                                                                             
        11 SCOTT              20       3000                                                                                                                                                             
        12 SMITH              20        800                                                                                                                                                             
        13 TURNER             30       1500                                                                                                                                                             
        14 WARD               30       1250                                                                                                                                                             

15 rows selected.

SQL> SELECT
  2   DENSE_RANK()
  3   OVER(ORDER BY Ename) RollNo,
  4   EName, Deptno, Sal
  5   FROM Emp
  6   ORDER BY RollNo;

    ROLLNO ENAME          DEPTNO        SAL                                                                                                                                                             
---------- ---------- ---------- ----------                                                                                                                                                             
         1 ADAMS              20       1100                                                                                                                                                             
         2 ALLEN              30                                                                                                                                                                        
         2 ALLEN              30       1600                                                                                                                                                             
         2 ALLEN              30                                                                                                                                                                        
         2 ALLEN              30                                                                                                                                                                        
         3 BLAKE              30       2850                                                                                                                                                             
         4 CLARK              10       2450                                                                                                                                                             
         5 FORD               20       3000                                                                                                                                                             
         6 JAMES              30        950                                                                                                                                                             
         6 JAMES              30        950                                                                                                                                                             
         7 JONES              20       2975                                                                                                                                                             
         8 KING               10       5000                                                                                                                                                             
         9 MARTIN             30       1250                                                                                                                                                             
        10 MILLER             10       1300                                                                                                                                                             
        11 SCOTT              20       3000                                                                                                                                                             
        12 SMITH              20        800                                                                                                                                                             
        13 TURNER             30       1500                                                                                                                                                             
        14 WARD               30       1250                                                                                                                                                             

18 rows selected.

SQL> SELECT
  2   DENSE_RANK()
  3   OVER(ORDER BY Ename, Empno) RollNo,
  4   EName, Deptno, Sal
  5   FROM Emp
  6   ORDER BY RollNo
  7  /

    ROLLNO ENAME          DEPTNO        SAL                                                                                                                                                             
---------- ---------- ---------- ----------                                                                                                                                                             
         1 ADAMS              20       1100                                                                                                                                                             
         2 ALLEN              30                                                                                                                                                                        
         3 ALLEN              30                                                                                                                                                                        
         4 ALLEN              30                                                                                                                                                                        
         5 ALLEN              30       1600                                                                                                                                                             
         6 BLAKE              30       2850                                                                                                                                                             
         7 CLARK              10       2450                                                                                                                                                             
         8 FORD               20       3000                                                                                                                                                             
         9 JAMES              30        950                                                                                                                                                             
        10 JAMES              30        950                                                                                                                                                             
        11 JONES              20       2975                                                                                                                                                             
        12 KING               10       5000                                                                                                                                                             
        13 MARTIN             30       1250                                                                                                                                                             
        14 MILLER             10       1300                                                                                                                                                             
        15 SCOTT              20       3000                                                                                                                                                             
        16 SMITH              20        800                                                                                                                                                             
        17 TURNER             30       1500                                                                                                                                                             
        18 WARD               30       1250                                                                                                                                                             

18 rows selected.

SQL> SELECT
  2   DENSE_RANK()
  3   OVER(ORDER BY Ename) RollNo,
  4   EName, Sal,
  5   DENSE_RANK()
  6   OVER(ORDER BY Sal DESC) RankSal,
  7   HireDate,
  8   DENSE_RANK()
  9   OVER(ORDER BY HireDate) SeniorRank,
 10   DENSE_RANK()
 11   OVER(ORDER BY HireDate DESC) JuniorRank
 12   FROM Emp
 13   ORDER BY RollNo;

    ROLLNO ENAME             SAL    RANKSAL HIREDATE  SENIORRANK JUNIORRANK                                                                                                                             
---------- ---------- ---------- ---------- --------- ---------- ----------                                                                                                                             
         1 ADAMS            1100         11 23-MAY-87         13          2                                                                                                                             
         2 ALLEN                          1                   14          1                                                                                                                             
         2 ALLEN                          1                   14          1                                                                                                                             
         2 ALLEN                          1                   14          1                                                                                                                             
         2 ALLEN            1600          7 20-FEB-81          2         13                                                                                                                             
         3 BLAKE            2850          5 01-MAY-81          5         10                                                                                                                             
         4 CLARK            2450          6 09-JUN-81          6          9                                                                                                                             
         5 FORD             3000          3 03-DEC-81         10          5                                                                                                                             
         6 JAMES             950         12 03-DEC-81         10          5                                                                                                                             
         6 JAMES             950         12                   14          1                                                                                                                             
         7 JONES            2975          4 02-APR-81          4         11                                                                                                                             
         8 KING             5000          2 17-NOV-81          9          6                                                                                                                             
         9 MARTIN           1250         10 28-SEP-81          8          7                                                                                                                             
        10 MILLER           1300          9 23-JAN-82         11          4                                                                                                                             
        11 SCOTT            3000          3 19-APR-87         12          3                                                                                                                             
        12 SMITH             800         13 17-DEC-80          1         14                                                                                                                             
        13 TURNER           1500          8 08-SEP-81          7          8                                                                                                                             
        14 WARD             1250         10 22-FEB-81          3         12                                                                                                                             

18 rows selected.

SQL> SELECT COMMISSION FROM EMP ORDER BY COMMISSION;
SELECT COMMISSION FROM EMP ORDER BY COMMISSION
       *
ERROR at line 1:
ORA-00904: "COMMISSION": invalid identifier 


SQL> SELECT COMM FROM EMP ORDER BY COMM;

      COMM                                                                                                                                                                                              
----------                                                                                                                                                                                              
         0                                                                                                                                                                                              
       300                                                                                                                                                                                              
       500                                                                                                                                                                                              
      1400                                                                                                                                                                                              
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        

18 rows selected.

SQL> SELECT COMM FROM EMP ORDER BY COMM DESC;

      COMM                                                                                                                                                                                              
----------                                                                                                                                                                                              
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
      1400                                                                                                                                                                                              
       500                                                                                                                                                                                              
       300                                                                                                                                                                                              
         0                                                                                                                                                                                              

18 rows selected.

SQL> SELECT EName, Deptno, Sal,
  2   RANK()
  3   OVER(PARTITION BY DeptNo
  4   ORDER BY Sal DESC) "TOP Sal"
  5   FROM Emp
  6   ORDER BY Deptno, Sal DESC;

ENAME          DEPTNO        SAL    TOP Sal                                                                                                                                                             
---------- ---------- ---------- ----------                                                                                                                                                             
KING               10       5000          1                                                                                                                                                             
CLARK              10       2450          2                                                                                                                                                             
MILLER             10       1300          3                                                                                                                                                             
FORD               20       3000          1                                                                                                                                                             
SCOTT              20       3000          1                                                                                                                                                             
JONES              20       2975          3                                                                                                                                                             
ADAMS              20       1100          4                                                                                                                                                             
SMITH              20        800          5                                                                                                                                                             
ALLEN              30                     1                                                                                                                                                             
ALLEN              30                     1                                                                                                                                                             
ALLEN              30                     1                                                                                                                                                             
BLAKE              30       2850          4                                                                                                                                                             
ALLEN              30       1600          5                                                                                                                                                             
TURNER             30       1500          6                                                                                                                                                             
WARD               30       1250          7                                                                                                                                                             
MARTIN             30       1250          7                                                                                                                                                             
JAMES              30        950          9                                                                                                                                                             
JAMES              30        950          9                                                                                                                                                             

18 rows selected.

SQL> SELECT EName, Deptno, Sal,
  2   DENSE_RANK()
  3   OVER(ORDER BY Sal DESC) EmpRank
  4   FROM Emp
  5   GROUP BY Deptno, EName, Sal
  6   ORDER BY EmpRank;

ENAME          DEPTNO        SAL    EMPRANK                                                                                                                                                             
---------- ---------- ---------- ----------                                                                                                                                                             
ALLEN              30                     1                                                                                                                                                             
KING               10       5000          2                                                                                                                                                             
FORD               20       3000          3                                                                                                                                                             
SCOTT              20       3000          3                                                                                                                                                             
JONES              20       2975          4                                                                                                                                                             
BLAKE              30       2850          5                                                                                                                                                             
CLARK              10       2450          6                                                                                                                                                             
ALLEN              30       1600          7                                                                                                                                                             
TURNER             30       1500          8                                                                                                                                                             
MILLER             10       1300          9                                                                                                                                                             
MARTIN             30       1250         10                                                                                                                                                             
WARD               30       1250         10                                                                                                                                                             
ADAMS              20       1100         11                                                                                                                                                             
JAMES              30        950         12                                                                                                                                                             
SMITH              20        800         13                                                                                                                                                             

15 rows selected.

SQL> SELECT EName, Deptno, Sal,
  2   RANK()
  3   OVER(PARTITION BY DeptNo
  4   ORDER BY Sal DESC) "TOP Sal"
  5   FROM Emp
  6   ORDER BY Deptno, Sal DESC
  7  .
SQL> ED
Wrote file afiedt.buf

  1  SELECT EName, Deptno, Sal,
  2   DENSE_RANK()
  3   OVER(PARTITION BY DeptNo
  4   ORDER BY Sal DESC) "TOP Sal"
  5   FROM Emp
  6*  ORDER BY Deptno, Sal DESC
SQL> /

ENAME          DEPTNO        SAL    TOP Sal                                                                                                                                                             
---------- ---------- ---------- ----------                                                                                                                                                             
KING               10       5000          1                                                                                                                                                             
CLARK              10       2450          2                                                                                                                                                             
MILLER             10       1300          3                                                                                                                                                             
FORD               20       3000          1                                                                                                                                                             
SCOTT              20       3000          1                                                                                                                                                             
JONES              20       2975          2                                                                                                                                                             
ADAMS              20       1100          3                                                                                                                                                             
SMITH              20        800          4                                                                                                                                                             
ALLEN              30                     1                                                                                                                                                             
ALLEN              30                     1                                                                                                                                                             
ALLEN              30                     1                                                                                                                                                             
BLAKE              30       2850          2                                                                                                                                                             
ALLEN              30       1600          3                                                                                                                                                             
TURNER             30       1500          4                                                                                                                                                             
WARD               30       1250          5                                                                                                                                                             
MARTIN             30       1250          5                                                                                                                                                             
JAMES              30        950          6                                                                                                                                                             
JAMES              30        950          6                                                                                                                                                             

18 rows selected.

SQL> SELECT Ename, HireDate, Sal,
  2   LAG(Sal, 1, 0)
  3   OVER(ORDER BY HireDate) PreSal
  4   FROM Emp;

ENAME      HIREDATE         SAL     PRESAL                                                                                                                                                              
---------- --------- ---------- ----------                                                                                                                                                              
SMITH      17-DEC-80        800          0                                                                                                                                                              
ALLEN      20-FEB-81       1600        800                                                                                                                                                              
WARD       22-FEB-81       1250       1600                                                                                                                                                              
JONES      02-APR-81       2975       1250                                                                                                                                                              
BLAKE      01-MAY-81       2850       2975                                                                                                                                                              
CLARK      09-JUN-81       2450       2850                                                                                                                                                              
TURNER     08-SEP-81       1500       2450                                                                                                                                                              
MARTIN     28-SEP-81       1250       1500                                                                                                                                                              
KING       17-NOV-81       5000       1250                                                                                                                                                              
FORD       03-DEC-81       3000       5000                                                                                                                                                              
JAMES      03-DEC-81        950       3000                                                                                                                                                              
MILLER     23-JAN-82       1300        950                                                                                                                                                              
SCOTT      19-APR-87       3000       1300                                                                                                                                                              
ADAMS      23-MAY-87       1100       3000                                                                                                                                                              
ALLEN                                 1100                                                                                                                                                              
JAMES                       950                                                                                                                                                                         
ALLEN                                  950                                                                                                                                                              
ALLEN                                                                                                                                                                                                   

18 rows selected.

SQL> SELECT Ename, HireDate, Sal,
  2   LAG(Sal, 1)
  3   OVER(ORDER BY HireDate) PreSal
  4   FROM Emp;

ENAME      HIREDATE         SAL     PRESAL                                                                                                                                                              
---------- --------- ---------- ----------                                                                                                                                                              
SMITH      17-DEC-80        800                                                                                                                                                                         
ALLEN      20-FEB-81       1600        800                                                                                                                                                              
WARD       22-FEB-81       1250       1600                                                                                                                                                              
JONES      02-APR-81       2975       1250                                                                                                                                                              
BLAKE      01-MAY-81       2850       2975                                                                                                                                                              
CLARK      09-JUN-81       2450       2850                                                                                                                                                              
TURNER     08-SEP-81       1500       2450                                                                                                                                                              
MARTIN     28-SEP-81       1250       1500                                                                                                                                                              
KING       17-NOV-81       5000       1250                                                                                                                                                              
FORD       03-DEC-81       3000       5000                                                                                                                                                              
JAMES      03-DEC-81        950       3000                                                                                                                                                              
MILLER     23-JAN-82       1300        950                                                                                                                                                              
SCOTT      19-APR-87       3000       1300                                                                                                                                                              
ADAMS      23-MAY-87       1100       3000                                                                                                                                                              
ALLEN                                 1100                                                                                                                                                              
JAMES                       950                                                                                                                                                                         
ALLEN                                  950                                                                                                                                                              
ALLEN                                                                                                                                                                                                   

18 rows selected.

SQL> SELECT Ename, HireDate, Sal,
  2   LAG(Sal, 1)
  3   OVER(ORDER BY HireDate) PreSal1,
  4   LAG(Sal, 2)
  5   OVER(ORDER BY HireDate) PreSal2,
  6   LAG(Sal, 3)
  7   OVER(ORDER BY HireDate) PreSal3,
  8   LAG(Sal, 4)
  9   OVER(ORDER BY HireDate) PreSal4,
 10   LAG(Sal, 5)
 11   OVER(ORDER BY HireDate) PreSal5 FROM Emp;

ENAME      HIREDATE         SAL    PRESAL1    PRESAL2    PRESAL3    PRESAL4    PRESAL5                                                                                                                  
---------- --------- ---------- ---------- ---------- ---------- ---------- ----------                                                                                                                  
SMITH      17-DEC-80        800                                                                                                                                                                         
ALLEN      20-FEB-81       1600        800                                                                                                                                                              
WARD       22-FEB-81       1250       1600        800                                                                                                                                                   
JONES      02-APR-81       2975       1250       1600        800                                                                                                                                        
BLAKE      01-MAY-81       2850       2975       1250       1600        800                                                                                                                             
CLARK      09-JUN-81       2450       2850       2975       1250       1600        800                                                                                                                  
TURNER     08-SEP-81       1500       2450       2850       2975       1250       1600                                                                                                                  
MARTIN     28-SEP-81       1250       1500       2450       2850       2975       1250                                                                                                                  
KING       17-NOV-81       5000       1250       1500       2450       2850       2975                                                                                                                  
FORD       03-DEC-81       3000       5000       1250       1500       2450       2850                                                                                                                  
JAMES      03-DEC-81        950       3000       5000       1250       1500       2450                                                                                                                  
MILLER     23-JAN-82       1300        950       3000       5000       1250       1500                                                                                                                  
SCOTT      19-APR-87       3000       1300        950       3000       5000       1250                                                                                                                  
ADAMS      23-MAY-87       1100       3000       1300        950       3000       5000                                                                                                                  
ALLEN                                 1100       3000       1300        950       3000                                                                                                                  
JAMES                       950                  1100       3000       1300        950                                                                                                                  
ALLEN                                  950                  1100       3000       1300                                                                                                                  
ALLEN                                             950                  1100       3000                                                                                                                  

18 rows selected.

SQL> ED
Wrote file afiedt.buf

  1  SELECT Ename, HireDate, Sal,
  2   LEAD(Sal, 1)
  3   OVER(ORDER BY HireDate) PreSal1,
  4   LEAD(Sal, 2)
  5   OVER(ORDER BY HireDate) PreSal2,
  6   LEAD(Sal, 3)
  7   OVER(ORDER BY HireDate) PreSal3,
  8   LEAD(Sal, 4)
  9   OVER(ORDER BY HireDate) PreSal4,
 10   LEAD(Sal, 5)
 11*  OVER(ORDER BY HireDate) PreSal5 FROM Emp
SQL> /

ENAME      HIREDATE         SAL    PRESAL1    PRESAL2    PRESAL3    PRESAL4    PRESAL5                                                                                                                  
---------- --------- ---------- ---------- ---------- ---------- ---------- ----------                                                                                                                  
SMITH      17-DEC-80        800       1600       1250       2975       2850       2450                                                                                                                  
ALLEN      20-FEB-81       1600       1250       2975       2850       2450       1500                                                                                                                  
WARD       22-FEB-81       1250       2975       2850       2450       1500       1250                                                                                                                  
JONES      02-APR-81       2975       2850       2450       1500       1250       5000                                                                                                                  
BLAKE      01-MAY-81       2850       2450       1500       1250       5000       3000                                                                                                                  
CLARK      09-JUN-81       2450       1500       1250       5000       3000        950                                                                                                                  
TURNER     08-SEP-81       1500       1250       5000       3000        950       1300                                                                                                                  
MARTIN     28-SEP-81       1250       5000       3000        950       1300       3000                                                                                                                  
KING       17-NOV-81       5000       3000        950       1300       3000       1100                                                                                                                  
FORD       03-DEC-81       3000        950       1300       3000       1100                                                                                                                             
JAMES      03-DEC-81        950       1300       3000       1100                   950                                                                                                                  
MILLER     23-JAN-82       1300       3000       1100                   950                                                                                                                             
SCOTT      19-APR-87       3000       1100                   950                                                                                                                                        
ADAMS      23-MAY-87       1100                   950                                                                                                                                                   
ALLEN                                  950                                                                                                                                                              
JAMES                       950                                                                                                                                                                         
ALLEN                                                                                                                                                                                                   
ALLEN                                                                                                                                                                                                   

18 rows selected.

SQL> SPOOL OFF
